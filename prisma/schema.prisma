// prisma/schema.prisma
generator client {
   provider = "prisma-client-js" 
   }
datasource db {
   provider = "postgresql" 
   url = env("PRISMA_DATABASE_URL2_DATABASE_URL") 
   }

model User {
  id             Int       @id @default(autoincrement())
  name           String
  username       String    @unique
  email          String?
  password       String
  employeeNumber String    @unique
  role           Role      @default(CLIENT)
  firstLogin     Boolean   @default(true)
  createdAt      DateTime  @default(now())
  deletedAt      DateTime? // soft delete

  idCards        IdCard[]
  submissions    Submission[]
}

model Submission {
  id             Int      @id @default(autoincrement())
  employeeName   String
  employeeNumber String
  pdfPath        String
  employerName   String
  dues           String
  witness        String
  submittedAt    DateTime @default(now())

  userId Int?
  user   User? @relation(fields: [userId], references: [id], onDelete: Cascade)

  @@index([userId])
}

model IdCard {
  id            Int      @id @default(autoincrement())
  user          User     @relation(fields: [userId], references: [id], onDelete: Cascade)
  userId        Int
  fullName      String
  rawPhotoUrl   String?
  cleanPhotoUrl String?
  company       String
  role          String
  issuedAt      DateTime @default(now())
  cardNumber    String   @unique

  @@index([userId])
}

enum Role {
  CLIENT
  ADMIN
  SUPERADMIN
}